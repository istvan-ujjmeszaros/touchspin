<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Bootstrap 5 Renderer Tests</title>
  <link rel="stylesheet" href="../html/assets/bootstrap/bootstrap-5.3.2.min.css">
  <script src="../html/assets/jquery/jquery-3.7.1.min.js"></script>
  <script src="../html/assets/bootstrap/bootstrap-5.3.2.bundle.min.js"></script>
  <link href="../../src/jquery.bootstrap-touchspin.css" rel="stylesheet" type="text/css" media="all">
  
  <style>
    .test-section { 
      margin: 20px; 
      padding: 15px; 
      border: 1px solid #ddd; 
      border-radius: 4px;
    }
    .controls { 
      margin-top: 10px; 
      display: flex; 
      flex-wrap: wrap; 
      gap: 5px; 
    }
    .controls button { 
      padding: 5px 10px; 
      font-size: 12px; 
      margin: 2px;
    }
    h4 { margin-top: 0; }
  </style>

  <!-- Install the core-backed jQuery wrapper -->
  <script type="module">
    import { installJqueryTouchSpin } from '../../packages/jquery-plugin/src/index.js';
    import Bootstrap5Renderer from '../../packages/renderers/bootstrap5/src/Bootstrap5Renderer.js';
    
    installJqueryTouchSpin(window.jQuery);
    
    // Set global default renderer
    globalThis.TouchSpinDefaultRenderer = Bootstrap5Renderer;
    
    // Keep for backwards compatibility with tests
    window.Bootstrap5Renderer = Bootstrap5Renderer;

    document.addEventListener('DOMContentLoaded', function() {
      const $ = window.jQuery;

      // Initialize inputs
      $('#input-basic').TouchSpin({ 
        min: 0, 
        max: 100 
      });
      
      $('#input-with-prefix').TouchSpin({ 
        prefix: '$', 
        postfix: '.00',
        prefix_extraclass: 'bs5-initial-prefix',
        postfix_extraclass: 'bs5-initial-postfix',
        min: 0,
        max: 100
      });
      
      $('#input-advanced').TouchSpin({ 
        min: 0, 
        max: 200 
      });
      
      $('#input-vertical').TouchSpin({ 
        verticalbuttons: true,
        min: 0, 
        max: 20 
      });

      // Button handlers for basic input
      document.querySelector('[data-testid="basic-update-prefix"]').addEventListener('click', () => {
        $('#input-basic').trigger('touchspin.updatesettings', [{ prefix: '$' }]);
      });
      
      document.querySelector('[data-testid="basic-update-postfix"]').addEventListener('click', () => {
        $('#input-basic').trigger('touchspin.updatesettings', [{ postfix: '.00' }]);
      });
      
      document.querySelector('[data-testid="basic-clear-prefix"]').addEventListener('click', () => {
        $('#input-basic').trigger('touchspin.updatesettings', [{ prefix: '' }]);
      });
      
      document.querySelector('[data-testid="basic-clear-postfix"]').addEventListener('click', () => {
        $('#input-basic').trigger('touchspin.updatesettings', [{ postfix: '' }]);
      });
      
      document.querySelector('[data-testid="basic-update-prefix-class"]').addEventListener('click', () => {
        $('#input-basic').trigger('touchspin.updatesettings', [{ prefix_extraclass: 'bs5-test-prefix-extra' }]);
      });
      
      document.querySelector('[data-testid="basic-update-postfix-class"]').addEventListener('click', () => {
        $('#input-basic').trigger('touchspin.updatesettings', [{ postfix_extraclass: 'bs5-test-postfix-extra' }]);
      });
      
      document.querySelector('[data-testid="basic-clear-prefix-class"]').addEventListener('click', () => {
        $('#input-basic').trigger('touchspin.updatesettings', [{ prefix_extraclass: '' }]);
      });
      
      document.querySelector('[data-testid="basic-clear-postfix-class"]').addEventListener('click', () => {
        $('#input-basic').trigger('touchspin.updatesettings', [{ postfix_extraclass: '' }]);
      });
      
      document.querySelector('[data-testid="basic-update-up-text"]').addEventListener('click', () => {
        $('#input-basic').trigger('touchspin.updatesettings', [{ buttonup_txt: 'â–²' }]);
      });
      
      document.querySelector('[data-testid="basic-update-down-text"]').addEventListener('click', () => {
        $('#input-basic').trigger('touchspin.updatesettings', [{ buttondown_txt: 'â–¼' }]);
      });
      
      document.querySelector('[data-testid="basic-reset-button-text"]').addEventListener('click', () => {
        $('#input-basic').trigger('touchspin.updatesettings', [{ buttonup_txt: '+', buttondown_txt: 'âˆ’' }]);
      });
      
      document.querySelector('[data-testid="basic-update-all"]').addEventListener('click', () => {
        $('#input-basic').trigger('touchspin.updatesettings', [{ 
          prefix: 'USD', 
          postfix: 'kg', 
          prefix_extraclass: 'bs5-combined-prefix', 
          postfix_extraclass: 'bs5-combined-postfix',
          buttonup_txt: 'â¬†',
          buttondown_txt: 'â¬‡'
        }]);
      });
      
      document.querySelector('[data-testid="basic-clear-all"]').addEventListener('click', () => {
        $('#input-basic').trigger('touchspin.updatesettings', [{ 
          prefix: '', 
          postfix: '', 
          prefix_extraclass: '', 
          postfix_extraclass: '',
          buttonup_txt: '+',
          buttondown_txt: 'âˆ’'
        }]);
      });

      // Button handlers for prefixed input
      document.querySelector('[data-testid="prefixed-update-prefix"]').addEventListener('click', () => {
        $('#input-with-prefix').trigger('touchspin.updatesettings', [{ prefix: 'USD' }]);
      });
      
      document.querySelector('[data-testid="prefixed-update-postfix"]').addEventListener('click', () => {
        $('#input-with-prefix').trigger('touchspin.updatesettings', [{ postfix: 'kg' }]);
      });
      
      document.querySelector('[data-testid="prefixed-clear-prefix"]').addEventListener('click', () => {
        $('#input-with-prefix').trigger('touchspin.updatesettings', [{ prefix: '' }]);
      });
      
      document.querySelector('[data-testid="prefixed-clear-postfix"]').addEventListener('click', () => {
        $('#input-with-prefix').trigger('touchspin.updatesettings', [{ postfix: '' }]);
      });
      
      document.querySelector('[data-testid="prefixed-update-prefix-class"]').addEventListener('click', () => {
        $('#input-with-prefix').trigger('touchspin.updatesettings', [{ prefix_extraclass: 'bs5-updated-prefix' }]);
      });
      
      document.querySelector('[data-testid="prefixed-update-postfix-class"]').addEventListener('click', () => {
        $('#input-with-prefix').trigger('touchspin.updatesettings', [{ postfix_extraclass: 'bs5-updated-postfix' }]);
      });
      
      document.querySelector('[data-testid="prefixed-clear-prefix-class"]').addEventListener('click', () => {
        $('#input-with-prefix').trigger('touchspin.updatesettings', [{ prefix_extraclass: '' }]);
      });
      
      document.querySelector('[data-testid="prefixed-clear-postfix-class"]').addEventListener('click', () => {
        $('#input-with-prefix').trigger('touchspin.updatesettings', [{ postfix_extraclass: '' }]);
      });
      
      document.querySelector('[data-testid="prefixed-update-up-text"]').addEventListener('click', () => {
        $('#input-with-prefix').trigger('touchspin.updatesettings', [{ buttonup_txt: 'â†‘' }]);
      });
      
      document.querySelector('[data-testid="prefixed-update-down-text"]').addEventListener('click', () => {
        $('#input-with-prefix').trigger('touchspin.updatesettings', [{ buttondown_txt: 'â†“' }]);
      });
      
      document.querySelector('[data-testid="prefixed-reset-button-text"]').addEventListener('click', () => {
        $('#input-with-prefix').trigger('touchspin.updatesettings', [{ buttonup_txt: '+', buttondown_txt: 'âˆ’' }]);
      });
      
      document.querySelector('[data-testid="prefixed-update-all"]').addEventListener('click', () => {
        $('#input-with-prefix').trigger('touchspin.updatesettings', [{ 
          prefix: 'ALL', 
          postfix: 'NEW', 
          prefix_extraclass: 'bs5-all-prefix', 
          postfix_extraclass: 'bs5-all-postfix',
          buttonup_txt: 'ðŸ“ˆ',
          buttondown_txt: 'ðŸ“‰'
        }]);
      });
      
      document.querySelector('[data-testid="prefixed-clear-all"]').addEventListener('click', () => {
        $('#input-with-prefix').trigger('touchspin.updatesettings', [{ 
          prefix: '', 
          postfix: '', 
          prefix_extraclass: '', 
          postfix_extraclass: '',
          buttonup_txt: '+',
          buttondown_txt: 'âˆ’'
        }]);
      });

      // Button handlers for advanced input
      document.querySelector('[data-testid="advanced-update-prefix"]').addEventListener('click', () => {
        $('#input-advanced').trigger('touchspin.updatesettings', [{ prefix: '$' }]);
      });
      
      document.querySelector('[data-testid="advanced-update-postfix"]').addEventListener('click', () => {
        $('#input-advanced').trigger('touchspin.updatesettings', [{ postfix: 'USD' }]);
      });
      
      document.querySelector('[data-testid="advanced-clear-prefix"]').addEventListener('click', () => {
        $('#input-advanced').trigger('touchspin.updatesettings', [{ prefix: '' }]);
      });
      
      document.querySelector('[data-testid="advanced-clear-postfix"]').addEventListener('click', () => {
        $('#input-advanced').trigger('touchspin.updatesettings', [{ postfix: '' }]);
      });

      // Button handlers for vertical input
      document.querySelector('[data-testid="vertical-update-up-class"]').addEventListener('click', () => {
        $('#input-vertical').trigger('touchspin.updatesettings', [{ verticalupclass: 'btn-success' }]);
      });
      
      document.querySelector('[data-testid="vertical-update-down-class"]').addEventListener('click', () => {
        $('#input-vertical').trigger('touchspin.updatesettings', [{ verticaldownclass: 'btn-danger' }]);
      });
      
      document.querySelector('[data-testid="vertical-update-up-text"]').addEventListener('click', () => {
        $('#input-vertical').trigger('touchspin.updatesettings', [{ verticalup: 'â¬†' }]);
      });
      
      document.querySelector('[data-testid="vertical-update-down-text"]').addEventListener('click', () => {
        $('#input-vertical').trigger('touchspin.updatesettings', [{ verticaldown: 'â¬‡' }]);
      });
    });
  </script>
</head>
<body class="container">
  <h1>Bootstrap 5 Renderer Test Page</h1>
  
  <!-- Basic input without prefix/postfix -->
  <div class="test-section">
    <h4>Basic Input (no initial prefix/postfix)</h4>
    <div data-testid="basic-container">
      <input data-testid="input-basic" id="input-basic" type="text" value="10" class="form-control" />
    </div>
    <div class="controls">
      <!-- Prefix/Postfix controls -->
      <button data-testid="basic-update-prefix" class="btn btn-primary btn-sm">Update Prefix ($)</button>
      <button data-testid="basic-update-postfix" class="btn btn-primary btn-sm">Update Postfix (.00)</button>
      <button data-testid="basic-clear-prefix" class="btn btn-secondary btn-sm">Clear Prefix</button>
      <button data-testid="basic-clear-postfix" class="btn btn-secondary btn-sm">Clear Postfix</button>
      
      <!-- Extra class controls -->
      <button data-testid="basic-update-prefix-class" class="btn btn-info btn-sm">Add Prefix Class</button>
      <button data-testid="basic-update-postfix-class" class="btn btn-info btn-sm">Add Postfix Class</button>
      <button data-testid="basic-clear-prefix-class" class="btn btn-warning btn-sm">Clear Prefix Class</button>
      <button data-testid="basic-clear-postfix-class" class="btn btn-warning btn-sm">Clear Postfix Class</button>
      
      <!-- Button text controls -->
      <button data-testid="basic-update-up-text" class="btn btn-success btn-sm">Update Up Text (â–²)</button>
      <button data-testid="basic-update-down-text" class="btn btn-success btn-sm">Update Down Text (â–¼)</button>
      <button data-testid="basic-reset-button-text" class="btn btn-secondary btn-sm">Reset Button Text</button>
      
      <!-- Combined controls -->
      <button data-testid="basic-update-all" class="btn btn-danger btn-sm">Update All</button>
      <button data-testid="basic-clear-all" class="btn btn-secondary btn-sm">Clear All</button>
    </div>
  </div>

  <!-- Input with initial prefix/postfix -->
  <div class="test-section">
    <h4>Input with Initial Prefix/Postfix</h4>
    <div data-testid="prefixed-container">
      <input data-testid="input-with-prefix" id="input-with-prefix" type="text" value="25" class="form-control" />
    </div>
    <div class="controls">
      <!-- Prefix/Postfix controls -->
      <button data-testid="prefixed-update-prefix" class="btn btn-primary btn-sm">Update Prefix (USD)</button>
      <button data-testid="prefixed-update-postfix" class="btn btn-primary btn-sm">Update Postfix (kg)</button>
      <button data-testid="prefixed-clear-prefix" class="btn btn-secondary btn-sm">Clear Prefix</button>
      <button data-testid="prefixed-clear-postfix" class="btn btn-secondary btn-sm">Clear Postfix</button>
      
      <!-- Extra class controls -->
      <button data-testid="prefixed-update-prefix-class" class="btn btn-info btn-sm">Update Prefix Class</button>
      <button data-testid="prefixed-update-postfix-class" class="btn btn-info btn-sm">Update Postfix Class</button>
      <button data-testid="prefixed-clear-prefix-class" class="btn btn-warning btn-sm">Clear Prefix Class</button>
      <button data-testid="prefixed-clear-postfix-class" class="btn btn-warning btn-sm">Clear Postfix Class</button>
      
      <!-- Button text controls -->
      <button data-testid="prefixed-update-up-text" class="btn btn-success btn-sm">Update Up Text (â†‘)</button>
      <button data-testid="prefixed-update-down-text" class="btn btn-success btn-sm">Update Down Text (â†“)</button>
      <button data-testid="prefixed-reset-button-text" class="btn btn-secondary btn-sm">Reset Button Text</button>
      
      <!-- Combined controls -->
      <button data-testid="prefixed-update-all" class="btn btn-danger btn-sm">Update All</button>
      <button data-testid="prefixed-clear-all" class="btn btn-secondary btn-sm">Clear All</button>
    </div>
  </div>

  <!-- Advanced container (existing input-group) -->
  <div class="test-section">
    <h4>Advanced Container (existing input-group)</h4>
    <div data-testid="advanced-container" class="input-group">
      <span class="input-group-text">â‚¬</span>
      <input data-testid="input-advanced" id="input-advanced" type="text" value="50" class="form-control" />
      <span class="input-group-text">EUR</span>
    </div>
    <div class="controls">
      <button data-testid="advanced-update-prefix" class="btn btn-primary btn-sm">Update Prefix ($)</button>
      <button data-testid="advanced-update-postfix" class="btn btn-primary btn-sm">Update Postfix (USD)</button>
      <button data-testid="advanced-clear-prefix" class="btn btn-secondary btn-sm">Clear Prefix</button>
      <button data-testid="advanced-clear-postfix" class="btn btn-secondary btn-sm">Clear Postfix</button>
    </div>
  </div>

  <!-- Vertical buttons test -->
  <div class="test-section">
    <h4>Vertical Buttons</h4>
    <div data-testid="vertical-container">
      <input data-testid="input-vertical" id="input-vertical" type="text" value="5" class="form-control" />
    </div>
    <div class="controls">
      <button data-testid="vertical-update-up-class" class="btn btn-info btn-sm">Update Up Class</button>
      <button data-testid="vertical-update-down-class" class="btn btn-info btn-sm">Update Down Class</button>
      <button data-testid="vertical-update-up-text" class="btn btn-success btn-sm">Update Up Text (â¬†)</button>
      <button data-testid="vertical-update-down-text" class="btn btn-success btn-sm">Update Down Text (â¬‡)</button>
    </div>
  </div>

</body>
</html>