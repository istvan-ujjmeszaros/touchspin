<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>TouchSpin A/B Compare (Original vs Wrapper)</title>
  <link rel="stylesheet" href="../html/assets/bootstrap/bootstrap-4.6.2.min.css">
  <script src="../html/assets/jquery/jquery-3.7.1.min.js"></script>
  <link href="../../src/jquery.bootstrap-touchspin.css" rel="stylesheet">
  <style>
    .test-section { margin: 30px 0; padding: 20px; border: 1px solid #ddd; border-radius: 5px; }
    .grid { display:grid; grid-template-columns: 1fr 1fr; gap: 20px; }
    pre { background:#f8f9fa; padding:10px; height: 180px; overflow:auto; }
  </style>

  <!-- Load original monolithic jQuery plugin v4.7.3 (no renderers needed) -->
  <script src="../html/assets/jquery.bootstrap-touchspin-v4.7.3-original.js"></script>
  <!-- Preserve original plugin under a different name before installing wrapper -->
  <script>
    (function($){
      if ($ && $.fn && $.fn.TouchSpin) {
        $.fn.OriginalTouchSpin = $.fn.TouchSpin;
        delete $.fn.TouchSpin; // Clear so new version can install
      }
    })(window.jQuery);
  </script>
</head>
<body class="container py-4">
  <h1 class="h4">A/B Compare: Original Plugin vs Wrapper (Core)</h1>
  <p class="text-muted">Original plugin (left) uses v4.7.3 monolithic version; Wrapper (right) uses new modular core + renderer architecture.</p>

  <div class="grid">
    <div class="test-section">
      <h2 class="h6">Original (v4.7.3)</h2>
      <input id="orig-input" type="text" value="42" class="form-control" data-testid="ab-orig">
      <div class="mt-2">
        <button onclick="$('#orig-input').OriginalTouchSpin({ min:0, max:100, step:5 })" class="btn btn-primary btn-sm">Init</button>
        <button onclick="$('#orig-input').trigger('touchspin.destroy')" class="btn btn-outline-danger btn-sm">Destroy</button>
        <button onclick="$('#orig-input').trigger('touchspin.uponce')" class="btn btn-outline-secondary btn-sm">Up Once</button>
        <button onclick="$('#orig-input').trigger('touchspin.downonce')" class="btn btn-outline-secondary btn-sm">Down Once</button>
      </div>
      <h6 class="mt-3">Events</h6>
      <pre id="orig-log"></pre>
    </div>

    <div class="test-section">
      <h2 class="h6">Wrapper (core)</h2>
      <input id="wrap-input" type="text" value="42" class="form-control" data-testid="ab-wrap">
      <div class="mt-2">
        <button onclick="$('#wrap-input').TouchSpin({ renderer: Bootstrap4Renderer, min:0, max:100, step:5 })" class="btn btn-primary btn-sm">Init</button>
        <button onclick="$('#wrap-input').trigger('touchspin.destroy')" class="btn btn-outline-danger btn-sm">Destroy</button>
        <button onclick="$('#wrap-input').TouchSpin('uponce')" class="btn btn-outline-secondary btn-sm">Up Once</button>
        <button onclick="$('#wrap-input').TouchSpin('downonce')" class="btn btn-outline-secondary btn-sm">Down Once</button>
      </div>
      <h6 class="mt-3">Events</h6>
      <pre id="wrap-log"></pre>
    </div>
  </div>

  <!-- Install the wrapper after original is loaded, so both can coexist -->
  <script type="module">
    import { installJqueryTouchSpin } from '../../packages/jquery-plugin/src/index.js';
    import Bootstrap4Renderer from '../../packages/renderers/bootstrap4/src/Bootstrap4Renderer.js';
    
    installJqueryTouchSpin(window.jQuery);
    window.Bootstrap4Renderer = Bootstrap4Renderer;
  </script>

  <script>
    (function(){
      const $ = window.jQuery;
      const $orig = $('#orig-input');
      const $wrap = $('#wrap-input');
      const origLog = document.getElementById('orig-log');
      const wrapLog = document.getElementById('wrap-log');

      function bindLog($input, logEl) {
        function add(msg){ const ts = new Date().toISOString().split('T')[1].replace('Z',''); logEl.textContent += `[${ts}] ${msg}\n`; logEl.scrollTop = logEl.scrollHeight; }
        const evs = 'touchspin.on.min touchspin.on.max touchspin.on.startspin touchspin.on.stopspin touchspin.on.startupspin touchspin.on.startdownspin touchspin.on.stopupspin touchspin.on.stopdownspin';
        $input.on(evs, function(e){ const ns=(e.namespace||''); const sub = ns.replace(/^on\./,'')||e.type; add(sub); });
        $input.on('change', function(){ add('change[' + this.value + ']'); });
      }

      bindLog($orig, origLog);
      bindLog($wrap, wrapLog);

      // All button functionality moved to inline onclick attributes
    })();
  </script>
</body>
</html>
