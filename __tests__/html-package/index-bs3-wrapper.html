<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>TouchSpin Wrapper Demo — Bootstrap 3</title>
  <link rel="stylesheet" href="../html/assets/bootstrap/bootstrap-3.4.1.min.css">
  <script src="../html/assets/jquery/jquery-3.7.1.min.js"></script>
  <script src="../html/assets/bootstrap/bootstrap-3.4.1.min.js"></script>
  <link href="../../packages/renderers/bootstrap3/dist/touchspin-bootstrap3.css" rel="stylesheet" type="text/css" media="all">
  <style>
    .test-section { margin: 30px 0; padding: 20px; border: 1px solid #ddd; border-radius: 5px; }
    pre { background:#f8f9fa; padding:10px; height: 220px; overflow:auto; }
  </style>

  <!-- Install the core-backed jQuery wrapper -->
  <script type="module">
    import { installJqueryTouchSpin } from '../../packages/jquery-plugin/dist/index.js';
    import Bootstrap3Renderer from '../../packages/renderers/bootstrap3/dist/index.js';

    installJqueryTouchSpin(window.jQuery);
    window.Bootstrap3Renderer = Bootstrap3Renderer;
  </script>
</head>
<body class="container">
  <h1 class="h5">TouchSpin Wrapper (Core) — Bootstrap 3</h1>
  <div class="test-section">
    <div class="form-group">
      <label for="bs3-input" class="control-label">Numeric input:</label>
      <input id="bs3-input" type="text" value="10" class="form-control" data-testid="bs3-group" />
    </div>
    <div class="form-group">
      <button id="btn-init" class="btn btn-primary btn-sm">Init</button>
      <button id="btn-destroy" class="btn btn-danger btn-sm">Destroy</button>
      <button id="btn-reinit" class="btn btn-success btn-sm">Reinit (different)</button>
      <button id="btn-toggle-disabled" class="btn btn-warning btn-sm">Toggle Disabled</button>
      <button id="btn-toggle-readonly" class="btn btn-warning btn-sm">Toggle Readonly</button>
    </div>
    <div class="form-group">
      <button id="btn-uponce" class="btn btn-default btn-sm">upOnce()</button>
      <button id="btn-downonce" class="btn btn-default btn-sm">downOnce()</button>
      <button id="btn-startup" class="btn btn-default btn-sm">startUpSpin()</button>
      <button id="btn-startdown" class="btn btn-default btn-sm">startDownSpin()</button>
      <button id="btn-stop" class="btn btn-default btn-sm">stopSpin()</button>
    </div>
    <div><strong>Status:</strong> <span id="status">Not initialized</span></div>
    <h6>Events</h6>
    <pre id="log"></pre>
  </div>

  <div class="test-section">
    <h6>Advanced Input Group (Bootstrap 3)</h6>
    <div class="form-group">
      <div class="input-group" id="bs3-adv-group">
        <span class="input-group-addon">€</span>
        <input id="bs3-adv-input" type="text" value="7" class="form-control" />
        <span class="input-group-addon">g</span>
      </div>
    </div>
    <div class="form-group">
      <button id="btn-adv-init" class="btn btn-primary btn-sm">Init (advanced)</button>
      <button id="btn-adv-destroy" class="btn btn-danger btn-sm">Destroy (advanced)</button>
    </div>
  </div>

  <script>
    (function(){
      const $ = window.jQuery;
      const $input = $('#bs3-input');
      const status = document.getElementById('status');
      const log = document.getElementById('log');
      function addLog(msg){ const ts = new Date().toISOString().split('T')[1].replace('Z',''); log.textContent += `[${ts}] ${msg}\n`; log.scrollTop = log.scrollHeight; }

      const evs = 'touchspin.on.min touchspin.on.max touchspin.on.startspin touchspin.on.stopspin touchspin.on.startupspin touchspin.on.startdownspin touchspin.on.stopupspin touchspin.on.stopdownspin';
      $input.on(evs, function(e){ const ns=(e.namespace||''); const sub = ns.replace(/^on\./,'')||e.type; addLog('core:' + sub); });
      $input.on('change', function(){ addLog('change[' + this.value + ']'); });

      function init(opts){ try { destroy(); } catch {} $input.TouchSpin({renderer: Bootstrap3Renderer, ...opts}); status.textContent = `Initialized (min ${opts.min}, max ${opts.max}, step ${opts.step})`; }
      function destroy(){ $input.trigger('touchspin.destroy'); status.textContent = 'Destroyed'; }

      document.getElementById('btn-init').addEventListener('click', () => init({ min:0, max:100, step:1 }));
      document.getElementById('btn-destroy').addEventListener('click', destroy);
      document.getElementById('btn-reinit').addEventListener('click', () => init({ min:5, max:50, step:5 }));
      document.getElementById('btn-uponce').addEventListener('click', () => $input.TouchSpin('uponce'));
      document.getElementById('btn-downonce').addEventListener('click', () => $input.TouchSpin('downonce'));
      document.getElementById('btn-startup').addEventListener('click', () => $input.TouchSpin('startupspin'));
      document.getElementById('btn-startdown').addEventListener('click', () => $input.TouchSpin('startdownspin'));
      document.getElementById('btn-stop').addEventListener('click', () => $input.TouchSpin('stopspin'));
      document.getElementById('btn-toggle-disabled').addEventListener('click', () => { const d=$input.is(':disabled'); $input.prop('disabled', !d); });
      document.getElementById('btn-toggle-readonly').addEventListener('click', () => { const r=$input.is('[readonly]'); $input.prop('readonly', !r); });

      // Advanced init/destroy (parent has .input-group)
      const $adv = $('#bs3-adv-input');
      document.getElementById('btn-adv-init').addEventListener('click', () => {
        try { $adv.trigger('touchspin.destroy'); } catch {}
        $adv.TouchSpin({ renderer: Bootstrap3Renderer, min: 0, max: 50, step: 1, prefix: '$', postfix: 'pcs' });
      });
      document.getElementById('btn-adv-destroy').addEventListener('click', () => { $adv.trigger('touchspin.destroy'); });
    })();
  </script>
</body>
</html>
